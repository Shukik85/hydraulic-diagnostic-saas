# План задач для AI Assistant — Реализация функционала Enterprise SaaS

Цель: реализовать функционал, представленный в интерфейсе, с соблюдением лучших практик безопасности и UX 2025 года. Все изменения выполнять точечными диффами по текущему SHA, придерживаясь pre-commit хуков из .pre-commit-config.yaml.

1. Аутентификация и управление пользователями
- Описать модель сессии, хранение access/refresh токенов, политику обновления, истечения и отзыва.
- Проработать роли и права (admin/engineer/viewer), матрицу доступа по маршрутам и действиям.
- Определить требования к PII: шифрование на хранении, маскирование в логах, минимизация.
- Реализовать механизмы восстановления пароля, подтверждения email, привязки MFA (TOTP/WebAuthn).
- Встроить защиту от брутфорса, CSRF, XSS, session fixation; задать secure cookie флаги.
- Прописать аудит входов/выходов, geo/ip-фингерпринт, алерты аномальной активности.

2. Дэшборд и аналитика в реальном времени
- Определить источники данных, частоты обновления, SLA для метрик (KPI, алерты, системный статус).
- Спроектировать канал real-time (WebSocket/SSE), формат сообщений, backpressure и ретраи.
- Описать агрегации и кэширование (Redis), политики инвалидации, деградацию при сбоях.
- Согласовать SLIs/SLOs: время рендеринга виджетов, допустимые лаги данных, нагрузочные профили.
- Встроить фичи наблюдаемости: метрики, трассировка, логи, алерты по задержкам/ошибкам.

3. Двигатель диагностики
- Описать API жизненного цикла: запуск, прогресс, отмена, завершение, получение результатов.
- Определить контракт входных данных (ручной ввод, загрузка файлов, интеграции), валидацию и схемы.
- Спроектировать обработку в фоне (очередь, idempotency, повторная попытка, дедупликация).
- Задать статусы задач и переходы, хранение артефактов (логи, промежуточные результаты, отчеты).
- Описать безопасность вычислений: квоты, ограничение ресурсов, таймауты, песочницы.

4. Управление данными датчиков
- Формализовать ingestion: CSV/API/SCADA, дедупликация, контроль целостности и временных меток.
- Описать нормализацию единиц измерения, очистку выбросов, интерполяцию пропусков.
- Спроектировать хранение таймсерий (ретеншн, downsampling, партиционирование, индексы).
- Определить правила триггеров и порогов, эскалации статусов, подавление флаппинга.
- Подготовить каналы отдачи для графиков и live-таблиц с пагинацией и фильтрами.

5. Отчеты и экспорт
- Определить типы отчетов (executive/technical/compliance), поля, визуализации и легенды.
- Описать генерацию PDF (брендинг, оглавление, номера страниц, вложения), локаль и шрифты.
- Реализовать расписания (cron), SLA подготовки, ретраи, уведомления о готовности.
- Организовать хранение версий, доступы, аудит скачиваний, политику retention и удаления.

6. AI-ассистент (чат)
- Определить провайдера LLM, политику токенов, лимиты затрат, контроль prompt-инъекций.
- Спроектировать RAG: источники знаний, индексация, обновление, контроль устаревания.
- Описать контекст сессии: структура, безопасность данных, многораундовый диалог.
- Настроить хранение переписки (PII safe), экспорт диалогов (PDF/Markdown), поиск по истории.

7. Интеграции систем
- Уточнить протоколы SCADA (Modbus/OPC-UA), модели безопасности и опроса.
- Спроектировать интеграции ERP/CMMS (план обслуживания, заявки), вебхуки и подписки.
- Реализовать нотификации (Slack/Teams/Email/SMS), шаблоны, локаль, политики частоты.
- Описать управление API-ключами, ротацию, квоты, мониторинг и rate limiting.

8. Наблюдаемость, безопасность и соответствие
- Включить централизованные логи, метрики и трассировки (корреляция по request-id, user-id).
- Задать политики: секреты (Vault), управление ключами, бэкапы, DRP/RTO/RPO.
- Провести DAST/SAST, зависимостной скан, SBOM, контроль лицензий, pre-commit и CI-проверки.
- Описать процесс инцидентов: классификация, коммуникации, postmortem, CAPA.

9. Инфраструктура и деплой
- Спроектировать окружения (dev/stage/prod), стратегии деплоя (blue/green, canary).
- Контейнеризация, сетевые политики, ingress/HTTPS, WAF/Rate-limit/CDN.
- Миграции БД, сиды, миграции схем API, обратная совместимость.
- Cost management: бюджетирование, автошип/автостоп, алерты бюджета.

10. Roadmap и инкрементальная поставка
- Сформировать релизы (эпики/спринты), критерии “Definition of Ready/Done”, риски и митигаторы.
- Приоритизировать: Auth → Dashboard RT → Diagnostics Core → Reports → Sensors → AI → Integrations.
- Ввести контроль качества: тест-план (unit/e2e/perf/security), тестовые данные, демо-сценарии.
- Подготовить операционную документацию и runbooks.

Инструкции по выполнению
- Все изменения коммитить малыми атомарными диффами с понятными сообщениями.
- Следовать .pre-commit-config.yaml и линтерам, не коммитить закомментированный код.
- Не добавлять непроверенные библиотеки; перед установкой — оценка безопасности и лицензии.
- Для данных и метрик использовать реальные источники; не подменять синтетикой в проде.
